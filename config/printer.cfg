#[include adxlmcu.cfg]
#[include TEST_SPEED.cfg]
[include mainsail.cfg]
[include macros.cfg]
[include K-ShakeTune/*.cfg]
[include moonraker_obico_macros.cfg]

[force_move]
enable_force_move: true

## Include other config files

[include homing.cfg]
[include steppers.cfg]
[include fans.cfg]
[include timelapse.cfg]              # delete # if timelapse.cfg will be used

## Which Probe Are We Using?
#[include bltouch.cfg]
[include eddy.cfg]
[probe_eddy_current btt_eddy]
#z_offset: 1.0


## EXTRUDER ##

[extruder]
step_pin: EBBCan: PD0
dir_pin: EBBCan: PD1
enable_pin: !EBBCan: PD2
microsteps: 16
rotation_distance: 5.61               #has to be calibrated by everyone
#gear_ratio: 50:17
full_steps_per_rotation: 200
nozzle_diameter: 0.400
filament_diameter: 1.750
heater_pin: EBBCan: PB13
sensor_type: ATC Semitec 104NT-4-R025H42G
sensor_pin: EBBCan: PA3
#control: pid
#pid_kp: 28.937
#pid_ki: 1.295
#pid_kd: 161.688
min_temp: 0
max_temp: 260
max_extrude_only_distance: 500
max_extrude_cross_section: 50.0
pressure_advance: 0.068

[tmc2209 extruder]
uart_pin: EBBCan: PA15
run_current: 0.650
stealthchop_threshold: 999999

############################################
# Heatbed & Mesh
############################################

[heater_bed]
heater_pin: PA1
sensor_pin: PF3 # TB
sensor_type: ATC Semitec 104GT-2
#control: watermark
min_temp: 0
max_temp: 130

#[z_tilt]
#z_positions:
#    -30,135
#    275,135
#points:
#    60,105
#    245,105
#speed: 140
#horizontal_move_z: 10
#retries: 7
#retry_tolerance: 0.015

#[bed_mesh]
#mesh_min: 15,15
#mesh_max: 201,250
#probe_count: 6,6
#mesh_pps: 2,3
#algorithm: bicubic
#speed: 50

#[output_pin probe_reset_pin]
#pin: PB13

[gcode_macro probe_reset]
gcode:
    SET_PIN PIN=probe_reset_pin VALUE=0
    G4 P300
    SET_PIN PIN=probe_reset_pin VALUE=1
    G4 P100

############################################
# Sensors
############################################

[input_shaper]
shaper_freq_x: 82.4
shaper_type_x: 3hump_ei
shaper_freq_y: 43.8
shaper_type_y: ei

[temperature_sensor OctopusPro]
sensor_type = temperature_mcu
min_temp = 0
max_temp = 90


#[temperature_sensor Chamber]
#sensor_type: NTC10K
#sensor_pin: PF4

[temperature_sensor RaspberryPi]
sensor_type: temperature_host
min_temp: 0
max_temp: 100

[temperature_sensor Toolhead]
sensor_type: temperature_mcu
sensor_mcu: EBBCan
min_temp = 0
max_temp = 100

############################################
# MCU & Printer
############################################

[mcu EBBCan] # EBB 42
canbus_uuid: 5ba4619971a4 #42
#canbus_uuid: a9ce72e0ac55 #36

[mcu] # OCTOPUS PRO 1.1
canbus_uuid: 6b62fbbd3a42

[printer]
kinematics: cartesian
max_velocity: 150
max_accel: 3500   
max_z_velocity: 5
max_z_accel: 100
#max_accel_to_decel: 2000
[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PE8, EXP1_2=PE7,
    EXP1_3=PE9, EXP1_4=PE10,
    EXP1_5=PE12, EXP1_6=PE13,    # Slot in the socket on this side
    EXP1_7=PE14, EXP1_8=PE15,
    EXP1_9=<GND>, EXP1_10=<5V>,

    # EXP2 header
    EXP2_1=PA6, EXP2_2=PA5,
    EXP2_3=PB1, EXP2_4=PA4,
    EXP2_5=PB2, EXP2_6=PA7,      # Slot in the socket on this side
    EXP2_7=PC15, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=PC5

# Enable arcs support
[gcode_arcs]
resolution: 0.1
[exclude_object]

[idle_timeout]
timeout = 43000

[respond]
default_type: echo
default_prefix: 

[virtual_sdcard]
path: ~/printer_data/gcodes
on_error_gcode: LED_RED_ERROR
[display_status]
[pause_resume]

############################################

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [extruder]
#*# control = pid
#*# pid_kp = 11.752
#*# pid_ki = 0.808
#*# pid_kd = 42.749
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 71.184
#*# pid_ki = 1.348
#*# pid_kd = 939.630
#*#
#*# [probe_eddy_current btt_eddy]
#*# reg_drive_current = 15
#*# calibrate =
#*# 	0.050000:3288001.479,0.100000:3286346.047,0.150000:3284761.208,
#*# 	0.200000:3283169.923,0.250000:3281607.348,0.300000:3280037.156,
#*# 	0.350000:3278589.323,0.400000:3277164.234,0.450000:3275800.539,
#*# 	0.500000:3274419.058,0.550000:3273103.985,0.600000:3271865.489,
#*# 	0.650000:3270590.796,0.700000:3269351.084,0.750000:3268230.169,
#*# 	0.800000:3267072.406,0.850000:3265948.670,0.900000:3264873.289,
#*# 	0.950000:3263823.370,1.000000:3262796.848,1.050000:3261808.882,
#*# 	1.100000:3260842.923,1.150000:3259901.990,1.200000:3259001.213,
#*# 	1.250000:3258112.284,1.300000:3257247.828,1.350000:3256375.763,
#*# 	1.400000:3255560.411,1.450000:3254744.547,1.500000:3253970.232,
#*# 	1.550000:3253191.052,1.600000:3252475.767,1.650000:3251722.114,
#*# 	1.700000:3251042.621,1.750000:3250355.339,1.800000:3249672.002,
#*# 	1.850000:3249016.364,1.900000:3248380.758,1.950000:3247772.344,
#*# 	2.000000:3247179.994,2.050000:3246562.868,2.100000:3245958.388,
#*# 	2.150000:3245436.811,2.200000:3244906.211,2.250000:3244353.592,
#*# 	2.300000:3243864.278,2.350000:3243302.079,2.400000:3242845.965,
#*# 	2.450000:3242318.073,2.500000:3241829.213,2.550000:3241367.566,
#*# 	2.600000:3240946.883,2.650000:3240493.882,2.700000:3240059.912,
#*# 	2.750000:3239619.294,2.800000:3239206.204,2.850000:3238857.774,
#*# 	2.900000:3238411.114,2.950000:3238050.721,3.000000:3237644.879,
#*# 	3.050000:3237282.555,3.100000:3236885.077,3.150000:3236578.124,
#*# 	3.200000:3236198.212,3.250000:3235868.138,3.300000:3235540.454,
#*# 	3.350000:3235220.655,3.400000:3234914.871,3.450000:3234604.056,
#*# 	3.500000:3234296.926,3.550000:3234005.953,3.600000:3233687.325,
#*# 	3.650000:3233425.870,3.700000:3233178.470,3.750000:3232892.984,
#*# 	3.800000:3232638.576,3.850000:3232351.321,3.900000:3232119.553,
#*# 	3.950000:3231846.458,4.000000:3231591.669,4.050000:3231363.648
#*# calibration_temp = 29.703623
#*# z_offset = 1.530
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.548419, -0.333765, -0.301901, -0.194828, -0.141036, -0.068777, 0.068301, 0.208311, 0.339550
#*# 	-0.467788, -0.270732, -0.261470, -0.210452, -0.152904, -0.057218, 0.062444, 0.211582, 0.320153
#*# 	-0.372691, -0.182187, -0.195817, -0.152361, -0.113665, -0.027420, 0.097245, 0.232103, 0.357393
#*# 	-0.337171, -0.131508, -0.078619, -0.081815, -0.062019, -0.000835, 0.101999, 0.226971, 0.336852
#*# 	-0.279929, -0.060856, -0.053204, -0.030901, -0.022942, 0.033526, 0.119680, 0.243772, 0.344918
#*# 	-0.233360, -0.034178, -0.016946, 0.024596, 0.035489, 0.078008, 0.154597, 0.266370, 0.353783
#*# 	-0.222834, 0.014701, 0.028775, 0.063199, 0.070184, 0.098878, 0.176132, 0.267504, 0.365782
#*# 	-0.207884, 0.026663, 0.027144, 0.069939, 0.089838, 0.130540, 0.191479, 0.281435, 0.350116
#*# 	-0.167034, 0.088388, 0.102837, 0.106566, 0.113046, 0.132571, 0.187891, 0.251885, 0.334894
#*# x_count = 9
#*# y_count = 9
#*# mesh_x_pps = 2
#*# mesh_y_pps = 3
#*# algo = bicubic
#*# tension = 0.2
#*# min_x = 5.0
#*# max_x = 235.0
#*# min_y = 5.0
#*# max_y = 235.0
